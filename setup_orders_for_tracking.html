<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∑–∞–∫–∞–∑–æ–≤ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–π</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 600px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 20px;
        }
        .info {
            background: #e8f4fd;
            border: 1px solid #bee5eb;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            border-left: 4px solid #17a2b8;
        }
        .warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            border-left: 4px solid #f39c12;
        }
        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            border-left: 4px solid #28a745;
        }
        .btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            display: block;
            width: 100%;
            margin-bottom: 10px;
            transition: all 0.3s ease;
        }
        .btn:hover {
            background: #5a67d8;
        }
        .btn-danger {
            background: #e74c3c;
        }
        .btn-danger:hover {
            background: #c0392b;
        }
        .results {
            margin-top: 20px;
            font-family: monospace;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîß –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã –∑–∞–∫–∞–∑–æ–≤</h1>
        
        <div class="info">
            <strong>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</strong><br>
            –≠—Ç–æ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –ø–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ—Ç —Å–∏—Å—Ç–µ–º—É –∑–∞–∫–∞–∑–æ–≤ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–π.
            –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤—Å—Ç—É–ø—è—Ç –≤ —Å–∏–ª—É —Å –∑–∞–≤—Ç—Ä–∞—à–Ω–µ–≥–æ –¥–Ω—è.
        </div>
        
        <div class="warning">
            <strong>–ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:</strong><br>
            ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ—à–∏–±–∫–∏ –≤ —Ä–∞–∑–¥–µ–ª–µ "–ü—Ä–æ–±–ª–µ–º—ã" (–ú–µ–Ω–µ–¥–∂–µ—Ä –≤–º–µ—Å—Ç–æ –ö–ª–∏–µ–Ω—Ç, –í–∏–¥—ã –æ–ø–µ—Ä–∞—Ü–∏–π –≤–º–µ—Å—Ç–æ –¢–æ–≤–∞—Ä)<br>
            ‚úÖ –£–±—Ä–∞–Ω—ã –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –≤ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö –∑–∞–∫–∞–∑–æ–≤<br>
            ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–æ–º–µ—Ä–∞ –∑–∞–∫–∞–∑–∞<br>
            ‚úÖ –í –∫–∞—Ä—Ç–æ—á–∫–µ –∑–∞–∫–∞–∑–∞ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ä–∞–±–æ—á–∏–µ —É—á–∞—Å—Ç–∫–∏<br>
            ‚úÖ –í—Å–µ –∑–∞–∫–∞–∑—ã –Ω–∞—á–∏–Ω–∞—é—Ç —Ä–∞–±–æ—Ç—É –≤–æ –≤–∫–ª–∞–¥–∫–µ "–í—Å–µ –∑–∞–∫–∞–∑—ã"
        </div>
        
        <button class="btn" onclick="checkCurrentOrders()">üìä –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –∑–∞–∫–∞–∑—ã</button>
        <button class="btn" onclick="prepareOrdersForTracking()">üîÑ –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –∑–∞–∫–∞–∑—ã –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è</button>
        <button class="btn" onclick="addTestOrders()">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –∑–∞–∫–∞–∑—ã</button>
        <button class="btn btn-danger" onclick="clearAllOrders()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –∑–∞–∫–∞–∑—ã</button>
        <button class="btn" onclick="openDashboard()">üöÄ –ü–µ—Ä–µ–π—Ç–∏ –∫ –¥–∞—à–±–æ—Ä–¥—É</button>
        
        <div id="results" class="results" style="display: none;"></div>
    </div>

    <script>
        function showResults(message) {
            const results = document.getElementById('results');
            results.textContent = message;
            results.style.display = 'block';
        }

        function checkCurrentOrders() {
            const orders = JSON.parse(localStorage.getItem('ordersData') || '[]');
            
            let report = `üìã –¢–ï–ö–£–©–ï–ï –°–û–°–¢–û–Ø–ù–ò–ï –ó–ê–ö–ê–ó–û–í:\n\n`;
            report += `–í—Å–µ–≥–æ –∑–∞–∫–∞–∑–æ–≤: ${orders.length}\n\n`;
            
            if (orders.length === 0) {
                report += `–ó–∞–∫–∞–∑—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç.\n`;
            } else {
                orders.forEach((order, index) => {
                    report += `${index + 1}. ${order.number}\n`;
                    report += `   –ú–µ–Ω–µ–¥–∂–µ—Ä: ${order.manager || order.client || '–ù–µ —É–∫–∞–∑–∞–Ω'}\n`;
                    report += `   –û–ø–µ—Ä–∞—Ü–∏–∏: ${order.operationType || order.product || '–ù–µ —É–∫–∞–∑–∞–Ω—ã'}\n`;
                    report += `   –£—á–∞—Å—Ç–æ–∫: ${order.currentSection || '–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω'}\n`;
                    report += `   –ü–µ—Ä–µ–º–µ—â–∞–ª—Å—è: ${order.history && order.history.some(h => h.action === 'moved') ? '–î–∞' : '–ù–µ—Ç'}\n`;
                    report += `   –ü—Ä–æ–±–ª–µ–º: ${order.issues ? order.issues.length : 0}\n\n`;
                });
            }
            
            showResults(report);
        }

        function prepareOrdersForTracking() {
            const orders = JSON.parse(localStorage.getItem('ordersData') || '[]');
            let prepared = 0;
            
            orders.forEach(order => {
                // –£–±–∏—Ä–∞–µ–º currentSection —É –∑–∞–∫–∞–∑–æ–≤ –±–µ–∑ –∏—Å—Ç–æ—Ä–∏–∏ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–π
                if (order.currentSection && (!order.history || !order.history.some(h => h.action === 'moved'))) {
                    order.currentSection = null;
                    prepared++;
                }
                
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∏—Å—Ç–æ—Ä–∏—é –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç
                if (!order.history) {
                    order.history = [{
                        action: 'created',
                        section: null,
                        sectionName: '–í—Å–µ –∑–∞–∫–∞–∑—ã',
                        timestamp: new Date().toISOString(),
                        user: '–°–∏—Å—Ç–µ–º–∞'
                    }];
                }
            });
            
            localStorage.setItem('ordersData', JSON.stringify(orders));
            
            let report = `‚úÖ –ü–û–î–ì–û–¢–û–í–ö–ê –ó–ê–í–ï–†–®–ï–ù–ê!\n\n`;
            report += `–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ –∑–∞–∫–∞–∑–æ–≤: ${orders.length}\n`;
            report += `–ü–µ—Ä–µ–º–µ—â–µ–Ω–æ –≤ "–í—Å–µ –∑–∞–∫–∞–∑—ã": ${prepared}\n\n`;
            report += `–¢–µ–ø–µ—Ä—å –≤—Å–µ –∑–∞–∫–∞–∑—ã –Ω–∞—á–∏–Ω–∞—é—Ç —Ä–∞–±–æ—Ç—É –≤–æ –≤–∫–ª–∞–¥–∫–µ "–í—Å–µ –∑–∞–∫–∞–∑—ã".\n`;
            report += `–° –∑–∞–≤—Ç—Ä–∞—à–Ω–µ–≥–æ –¥–Ω—è –≤—Å–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è –±—É–¥—É—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å—Å—è.\n`;
            
            showResults(report);
        }

        function addTestOrders() {
            const testOrders = [
                {
                    id: 'TEST_001',
                    number: 'TEST-001',
                    manager: '–ò–≤–∞–Ω–æ–≤ –ò.–ò.',
                    operationType: '–†–ì–°–≤',
                    date: new Date().toISOString().split('T')[0],
                    currentSection: null,
                    history: [{
                        action: 'created',
                        section: null,
                        sectionName: '–í—Å–µ –∑–∞–∫–∞–∑—ã',
                        timestamp: new Date().toISOString(),
                        user: '–°–∏—Å—Ç–µ–º–∞'
                    }]
                },
                {
                    id: 'TEST_002',
                    number: 'TEST-002',
                    manager: '–ü–µ—Ç—Ä–æ–≤ –ü.–ü.',
                    operationType: '–†–ü–∫',
                    date: new Date().toISOString().split('T')[0],
                    currentSection: null,
                    history: [{
                        action: 'created',
                        section: null,
                        sectionName: '–í—Å–µ –∑–∞–∫–∞–∑—ã',
                        timestamp: new Date().toISOString(),
                        user: '–°–∏—Å—Ç–µ–º–∞'
                    }],
                    issues: [{
                        description: '–ù—É–∂–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è –ø–æ–∫—Ä–∞—Å–∫–∏',
                        timestamp: new Date().toISOString(),
                        user: '–ü–µ—Ç—Ä–æ–≤ –ü.–ü.',
                        resolved: false
                    }]
                }
            ];
            
            const existingOrders = JSON.parse(localStorage.getItem('ordersData') || '[]');
            const allOrders = [...existingOrders, ...testOrders];
            localStorage.setItem('ordersData', JSON.stringify(allOrders));
            
            let report = `‚úÖ –¢–ï–°–¢–û–í–´–ï –ó–ê–ö–ê–ó–´ –î–û–ë–ê–í–õ–ï–ù–´!\n\n`;
            report += `–î–æ–±–∞–≤–ª–µ–Ω–æ –∑–∞–∫–∞–∑–æ–≤: ${testOrders.length}\n`;
            report += `–í—Å–µ–≥–æ –∑–∞–∫–∞–∑–æ–≤ –≤ —Å–∏—Å—Ç–µ–º–µ: ${allOrders.length}\n\n`;
            report += `TEST-001: –û–ø–µ—Ä–∞—Ü–∏–∏ –†–ì–°–≤ (–†–µ–∑–∫–∞, –ó–∞—á–∏—Å—Ç–∫–∞, –°–≤–∞—Ä–∫–∞)\n`;
            report += `TEST-002: –û–ø–µ—Ä–∞—Ü–∏–∏ –†–ü–∫ (–†–µ–∑–∫–∞, –ü–æ–∫—Ä–∞—Å–∫–∞) + 1 –ø—Ä–æ–±–ª–µ–º–∞\n`;
            
            showResults(report);
        }

        function clearAllOrders() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –í–°–ï –∑–∞–∫–∞–∑—ã? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!')) {
                localStorage.removeItem('ordersData');
                showResults('üóëÔ∏è –í—Å–µ –∑–∞–∫–∞–∑—ã —É–¥–∞–ª–µ–Ω—ã.');
            }
        }

        function openDashboard() {
            window.open('mobile_order_dashboard.html', '_blank');
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', () => {
            checkCurrentOrders();
        });
    </script>
</body>
</html>
