<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç —Å–∏—Å—Ç–µ–º—ã</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .test-panel {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .btn:hover {
            background: #5a67d8;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .success {
            background: #d4edda;
            color: #155724;
        }
        .info {
            background: #d1ecf1;
            color: #0c5460;
        }
    </style>
</head>
<body>
    <h1>üß™ –ü–∞–Ω–µ–ª—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã</h1>
    
    <div class="test-panel">
        <h3>üîê –¢–µ—Å—Ç—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏</h3>
        <button class="btn" onclick="clearAuth()">–û—á–∏—Å—Ç–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é</button>
        <button class="btn" onclick="setTestUser()">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
        <button class="btn" onclick="checkAuth()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é</button>
        <div id="authStatus" class="status info">–ù–∞–∂–º–∏—Ç–µ "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é"</div>
    </div>

    <div class="test-panel">
        <h3>üì¶ –¢–µ—Å—Ç—ã –¥–∞–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤</h3>
        <button class="btn" onclick="clearOrders()">–û—á–∏—Å—Ç–∏—Ç—å –∑–∞–∫–∞–∑—ã</button>
        <button class="btn" onclick="createTestOrders()">–°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –∑–∞–∫–∞–∑—ã</button>
        <button class="btn" onclick="viewOrders()">–ü–æ–∫–∞–∑–∞—Ç—å –∑–∞–∫–∞–∑—ã</button>
        <div id="ordersStatus" class="status info">–ù–∞–∂–º–∏—Ç–µ "–ü–æ–∫–∞–∑–∞—Ç—å –∑–∞–∫–∞–∑—ã"</div>
    </div>

    <div class="test-panel">
        <h3>üîÑ –¢–µ—Å—Ç—ã –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–π</h3>
        <button class="btn" onclick="testMoveOrder()">–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –∑–∞–∫–∞–∑ –Ω–∞ "–†–µ–∑–∫—É"</button>
        <button class="btn" onclick="testProgressCalculation()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞—Å—á–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞</button>
        <div id="moveStatus" class="status info">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤ –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å</div>
    </div>

    <div class="test-panel">
        <h3>üöÄ –ë—ã—Å—Ç—Ä—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã</h3>
        <button class="btn" onclick="goToAuth()">‚Üí –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</button>
        <button class="btn" onclick="goToDashboard()">‚Üí –î–∞—à–±–æ—Ä–¥</button>
        <button class="btn" onclick="goToReports()">‚Üí –û—Ç—á–µ—Ç—ã</button>
        <button class="btn" onclick="goToDemo()">‚Üí –î–µ–º–æ</button>
    </div>

    <script>
        // –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ —É—á–∞—Å—Ç–∫–∏
        const SECTIONS = {
            cutting: { name: '–†–µ–∑–∫–∞', icon: 'üî™', order: 1 },
            cleaning: { name: '–ó–∞—á–∏—Å—Ç–∫–∞/–¢—Ä–∞–≤–ª–µ–Ω–∏–µ', icon: 'üßπ', order: 2 },
            welding: { name: '–°–≤–∞—Ä–∫–∞', icon: '‚ö°', order: 3 },
            painting: { name: '–ü–æ–∫—Ä–∞—Å–∫–∞', icon: 'üé®', order: 4 },
            warehouse: { name: '–°–∫–ª–∞–¥', icon: 'üì¶', order: 5 },
            shipped: { name: '–û—Ç–≥—Ä—É–∂–µ–Ω–æ', icon: 'üöõ', order: 6 }
        };

        // –¢–µ—Å—Ç—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        function clearAuth() {
            localStorage.removeItem('userProfile');
            sessionStorage.removeItem('userProfile');
            document.getElementById('authStatus').innerHTML = '‚úÖ –î–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –æ—á–∏—â–µ–Ω—ã';
            document.getElementById('authStatus').className = 'status success';
        }

        function setTestUser() {
            const testUser = {
                firstName: '–¢–µ—Å—Ç',
                lastName: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å',
                fullName: '–¢–µ—Å—Ç –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å',
                loginTime: new Date().toISOString(),
                rememberMe: true
            };
            
            localStorage.setItem('userProfile', JSON.stringify(testUser));
            document.getElementById('authStatus').innerHTML = '‚úÖ –¢–µ—Å—Ç–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–Ω: ' + testUser.fullName;
            document.getElementById('authStatus').className = 'status success';
        }

        function checkAuth() {
            const userData = localStorage.getItem('userProfile') || sessionStorage.getItem('userProfile');
            const statusEl = document.getElementById('authStatus');
            
            if (userData) {
                const user = JSON.parse(userData);
                statusEl.innerHTML = '‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω: ' + user.fullName + '<br>–í—Ä–µ–º—è –≤—Ö–æ–¥–∞: ' + new Date(user.loginTime).toLocaleString('ru-RU');
                statusEl.className = 'status success';
            } else {
                statusEl.innerHTML = '‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω';
                statusEl.className = 'status info';
            }
        }

        // –¢–µ—Å—Ç—ã –∑–∞–∫–∞–∑–æ–≤
        function clearOrders() {
            localStorage.removeItem('ordersData');
            document.getElementById('ordersStatus').innerHTML = '‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑–æ–≤ –æ—á–∏—â–µ–Ω—ã';
            document.getElementById('ordersStatus').className = 'status success';
        }

        function createTestOrders() {
            const testOrders = [
                {
                    id: 'TEST001',
                    number: 'TEST-001',
                    client: '–û–û–û "–¢–µ—Å—Ç–ö–æ–º–ø–∞–Ω–∏—è"',
                    product: '–¢–µ—Å—Ç–æ–≤–∞—è –º–µ—Ç–∞–ª–ª–æ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è',
                    date: '2024-10-11',
                    currentSection: null,
                    progress: 0,
                    history: [
                        {
                            action: 'created',
                            section: null,
                            timestamp: new Date().toISOString(),
                            user: '–¢–µ—Å—Ç –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å'
                        }
                    ]
                },
                {
                    id: 'TEST002',
                    number: 'TEST-002',
                    client: '–ò–ü –¢–µ—Å—Ç–æ–≤ –ê.–ê.',
                    product: '–¢–µ—Å—Ç–æ–≤—ã–µ –≤–æ—Ä–æ—Ç–∞',
                    date: '2024-10-11',
                    currentSection: 'cutting',
                    progress: 17,
                    history: [
                        {
                            action: 'created',
                            section: null,
                            timestamp: new Date(Date.now() - 3600000).toISOString(),
                            user: '–¢–µ—Å—Ç –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å'
                        },
                        {
                            action: 'moved',
                            section: 'cutting',
                            sectionName: '–†–µ–∑–∫–∞',
                            timestamp: new Date().toISOString(),
                            user: '–¢–µ—Å—Ç –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å'
                        }
                    ]
                }
            ];
            
            localStorage.setItem('ordersData', JSON.stringify(testOrders));
            document.getElementById('ordersStatus').innerHTML = '‚úÖ –°–æ–∑–¥–∞–Ω–æ ' + testOrders.length + ' —Ç–µ—Å—Ç–æ–≤—ã—Ö –∑–∞–∫–∞–∑–∞';
            document.getElementById('ordersStatus').className = 'status success';
        }

        function viewOrders() {
            const ordersData = localStorage.getItem('ordersData');
            const statusEl = document.getElementById('ordersStatus');
            
            if (ordersData) {
                const orders = JSON.parse(ordersData);
                let info = `‚úÖ –ù–∞–π–¥–µ–Ω–æ ${orders.length} –∑–∞–∫–∞–∑–æ–≤:<br>`;
                
                orders.forEach(order => {
                    const currentSection = order.currentSection ? SECTIONS[order.currentSection].name : '–ù–æ–≤—ã–π –∑–∞–∫–∞–∑';
                    info += `‚Ä¢ ${order.number} - ${order.product} (${currentSection}, ${order.progress}%)<br>`;
                });
                
                statusEl.innerHTML = info;
                statusEl.className = 'status success';
            } else {
                statusEl.innerHTML = '‚ùå –ó–∞–∫–∞–∑—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã';
                statusEl.className = 'status info';
            }
        }

        // –¢–µ—Å—Ç—ã –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–π
        function testMoveOrder() {
            const ordersData = localStorage.getItem('ordersData');
            const statusEl = document.getElementById('moveStatus');
            
            if (!ordersData) {
                statusEl.innerHTML = '‚ùå –°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –∑–∞–∫–∞–∑—ã';
                statusEl.className = 'status info';
                return;
            }
            
            const orders = JSON.parse(ordersData);
            const order = orders.find(o => !o.currentSection);
            
            if (!order) {
                statusEl.innerHTML = '‚ùå –ù–µ—Ç –∑–∞–∫–∞–∑–æ–≤ –¥–ª—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è (–≤—Å–µ —É–∂–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω—ã)';
                statusEl.className = 'status info';
                return;
            }
            
            // –ü–µ—Ä–µ–º–µ—â–∞–µ–º –∑–∞–∫–∞–∑ –Ω–∞ —Ä–µ–∑–∫—É
            order.currentSection = 'cutting';
            order.progress = Math.round((SECTIONS.cutting.order / Object.keys(SECTIONS).length) * 100);
            order.history.push({
                action: 'moved',
                section: 'cutting',
                sectionName: '–†–µ–∑–∫–∞',
                timestamp: new Date().toISOString(),
                user: '–¢–µ—Å—Ç –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å'
            });
            
            localStorage.setItem('ordersData', JSON.stringify(orders));
            
            statusEl.innerHTML = `‚úÖ –ó–∞–∫–∞–∑ ${order.number} –ø–µ—Ä–µ–º–µ—â–µ–Ω –Ω–∞ "–†–µ–∑–∫–∞" (${order.progress}% –ø—Ä–æ–≥—Ä–µ—Å—Å–∞)`;
            statusEl.className = 'status success';
        }

        function testProgressCalculation() {
            const statusEl = document.getElementById('moveStatus');
            let info = '‚úÖ –¢–µ—Å—Ç —Ä–∞—Å—á–µ—Ç–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞:<br>';
            
            Object.keys(SECTIONS).forEach(sectionKey => {
                const section = SECTIONS[sectionKey];
                const progress = Math.round((section.order / Object.keys(SECTIONS).length) * 100);
                info += `‚Ä¢ ${section.name}: ${progress}%<br>`;
            });
            
            statusEl.innerHTML = info;
            statusEl.className = 'status success';
        }

        // –ë—ã—Å—Ç—Ä—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã
        function goToAuth() {
            window.open('auth.html', '_blank');
        }

        function goToDashboard() {
            window.open('mobile_order_dashboard.html', '_blank');
        }

        function goToReports() {
            window.open('reports.html', '_blank');
        }

        function goToDemo() {
            window.open('full_app_demo.html', '_blank');
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            checkAuth();
            viewOrders();
        });
    </script>
</body>
</html>